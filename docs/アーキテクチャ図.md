## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€aix-platform ã®å…¨ä½“åƒã‚’å›³ã§è§£èª¬ã—ã¾ã™ã€‚  
å›³ã¯ Mermaid è¨˜æ³•ã§è¨˜è¿°ã—ã¦ã„ã¾ã™ï¼ˆGitHub / VS Code / Cursor ã§è¡¨ç¤ºå¯èƒ½ï¼‰ã€‚

---

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³ï¼ˆå…¨ä½“æ¦‚è¦ï¼‰

ä»¥ä¸‹ã®å›³ã¯ã€ã‚¢ãƒ—ãƒªå…¨ä½“ã®æ§‹æˆã‚’1æšã«ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚  
å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ1ã€œ6ï¼‰ã®è©³ç´°ã¯å¾Œè¿°ã® Mermaid å›³ã§ç¢ºèªã§ãã¾ã™ã€‚

![ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³](./images/ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³.png)

**å›³ã®æ§‹æˆ:**
| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | å†…å®¹ |
|---|---|
| 1. å…¨ä½“ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³ | ãƒ–ãƒ©ã‚¦ã‚¶ãƒ»ã‚µãƒ¼ãƒãƒ¼ãƒ»DBã®3å±¤æ§‹æˆ |
| 2. ç”»é¢é·ç§»å›³ | Home / Vocab / Quiz é–“ã®é·ç§» |
| 3. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³ | ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ãƒ»å˜èªè¿½åŠ ãƒ»å‰Šé™¤ã®å‡¦ç†ã®æµã‚Œ |
| 4. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆå›³ | å„ãƒ«ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ Server/Client ã®åŒºåˆ† |
| 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«å›³ | Word ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒ |
| 6. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯æ¦‚è¦å›³ | ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸€è¦§ |

---

### 1. å…¨ä½“ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆClient Componentï¼‰ã€Next.js ã‚µãƒ¼ãƒãƒ¼ï¼ˆServer Component / Server Actionsï¼‰ã€
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSQLiteï¼‰ã®3å±¤æ§‹æˆã§ã™ã€‚

```mermaid
graph TB
    subgraph Browser["ğŸŒ ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ï¼‰"]
        CC1["app/page.tsx<br/>ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰<br/><i>Client Component</i>"]
        CC2["VocabularyList.tsx<br/>å˜èªä¸€è¦§ è¡¨ç¤º/å‰Šé™¤<br/><i>Client Component</i>"]
        CC3["QuizPlayer.tsx<br/>ã‚¯ã‚¤ã‚ºUI<br/><i>Client Component</i>"]
    end

    subgraph Server["âš™ï¸ Next.js ã‚µãƒ¼ãƒãƒ¼ï¼ˆã‚µãƒ¼ãƒãƒ¼å´ï¼‰"]
        SC1["app/vocabulary/page.tsx<br/>å˜èªå¸³ãƒšãƒ¼ã‚¸<br/><i>Server Component</i>"]
        SC2["app/quiz/page.tsx<br/>ã‚¯ã‚¤ã‚ºãƒšãƒ¼ã‚¸<br/><i>Server Component</i>"]
        SA["app/vocabulary/actions.ts<br/>Server Actions<br/><i>addVocabulary / getVocabularies / deleteVocabulary</i>"]
        PC["app/lib/prisma.ts<br/>Prisma Client<br/><i>ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³</i>"]
        Layout["app/layout.tsx<br/>å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ"]
    end

    subgraph DB["ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"]
        SQLite["prisma/dev.db<br/>SQLite<br/><i>Word ãƒ†ãƒ¼ãƒ–ãƒ«</i>"]
    end

    CC1 -->|"Link é·ç§»"| SC1
    CC1 -->|"Link é·ç§»"| SC2
    SC1 -->|"ãƒ‡ãƒ¼ã‚¿å–å¾—"| SA
    SC1 -->|"props æ¸¡ã—"| CC2
    SC2 -->|"ãƒ‡ãƒ¼ã‚¿å–å¾—"| SA
    SC2 -->|"props æ¸¡ã—"| CC3
    CC2 -->|"å‰Šé™¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆ"| SA
    SA -->|"DBæ“ä½œ"| PC
    PC -->|"SQLç™ºè¡Œ"| SQLite
    Layout -->|"å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæç”»"| CC1
    Layout -->|"å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæç”»"| SC1
    Layout -->|"å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæç”»"| SC2
```

**èª­ã¿æ–¹:**
- **é’ã®ä¸Šæ®µï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ï¼‰**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç›´æ¥æ“ä½œã™ã‚‹éƒ¨åˆ†ã€‚`useState` ã§UIã®çŠ¶æ…‹ç®¡ç†ã€‚
- **ä¸­æ®µï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰**: Next.js ãŒå‡¦ç†ã™ã‚‹éƒ¨åˆ†ã€‚ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚„DBæ“ä½œã‚’æ‹…å½“ã€‚
- **ä¸‹æ®µï¼ˆDBï¼‰**: SQLite ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãŒæ°¸ç¶šä¿å­˜ã•ã‚Œã‚‹ã€‚

---

### 2. ç”»é¢é·ç§»å›³

3ã¤ã®ç”»é¢ãŒç›¸äº’ã«ãƒªãƒ³ã‚¯ã§é·ç§»ã§ãã¾ã™ã€‚

```mermaid
graph LR
    Home["/ <br/>ã‚¿ã‚¹ã‚¯ç®¡ç†<br/>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"]
    Vocab["/vocabulary <br/>TOEIC<br/>å˜èªå¸³"]
    Quiz["/quiz <br/>ã‚¯ã‚¤ã‚º<br/>ç”»é¢"]

    Home -->|"å˜èªå¸³ãƒœã‚¿ãƒ³"| Vocab
    Home -->|"ã‚¯ã‚¤ã‚ºãƒœã‚¿ãƒ³"| Quiz
    Vocab -->|"ãƒ›ãƒ¼ãƒ ãƒœã‚¿ãƒ³"| Home
    Vocab -->|"ã‚¯ã‚¤ã‚ºãƒœã‚¿ãƒ³"| Quiz
    Quiz -->|"å˜èªå¸³ã¸ãƒœã‚¿ãƒ³"| Vocab

    style Home fill:#1e293b,stroke:#6366f1,color:#e2e8f0
    style Vocab fill:#1e293b,stroke:#22d3ee,color:#e2e8f0
    style Quiz fill:#1e293b,stroke:#34d399,color:#e2e8f0
```

**ãƒã‚¤ãƒ³ãƒˆ:**
- å…¨ã¦ã®ãƒšãƒ¼ã‚¸ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«ä»–ç”»é¢ã¸ã®é·ç§»ãƒœã‚¿ãƒ³ãŒã‚ã‚‹
- Next.js ã® `Link` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ SPA é·ç§»ï¼ˆãƒšãƒ¼ã‚¸å…¨ä½“ã®å†èª­ã¿è¾¼ã¿ãªã—ï¼‰

---

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³ï¼ˆå˜èªå¸³ã‚¢ãƒ—ãƒªã®å‡¦ç†ã®æµã‚Œï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‹ã‚‰DBä¿å­˜ãƒ»å–å¾—ã¾ã§ã®ä¸€é€£ã®æµã‚Œã‚’æ™‚ç³»åˆ—ã§ç¤ºã—ã¾ã™ã€‚

```mermaid
sequenceDiagram
    participant B as ğŸŒ ãƒ–ãƒ©ã‚¦ã‚¶
    participant SC as âš™ï¸ Server Component<br/>(page.tsx)
    participant SA as âš™ï¸ Server Action<br/>(actions.ts)
    participant P as ğŸ“¦ Prisma Client
    participant DB as ğŸ—„ï¸ SQLite<br/>(dev.db)

    Note over B,DB: ã€ãƒšãƒ¼ã‚¸è¡¨ç¤ºæ™‚ã€‘
    B->>SC: /vocabulary ã«ã‚¢ã‚¯ã‚»ã‚¹
    SC->>SA: getVocabularies() å‘¼ã³å‡ºã—
    SA->>P: prisma.word.findMany()
    P->>DB: SELECT * FROM Word ORDER BY createdAt DESC
    DB-->>P: çµæœã‚»ãƒƒãƒˆ
    P-->>SA: Word[]
    SA-->>SC: { id, word, meaning, createdAt }[]
    SC-->>B: HTMLã‚’è¿”å´ï¼ˆVocabularyList ã« props ã¨ã—ã¦æ¸¡ã™ï¼‰

    Note over B,DB: ã€å˜èªè¿½åŠ æ™‚ã€‘
    B->>SA: ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ â†’ addVocabulary(formData)
    SA->>P: prisma.word.create({ data: {...} })
    P->>DB: INSERT INTO Word (english, japanese) VALUES (...)
    DB-->>P: ä½œæˆã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰
    P-->>SA: Word
    SA-->>B: { success: true }
    B->>SC: router.refresh() ã§ãƒšãƒ¼ã‚¸å†å–å¾—

    Note over B,DB: ã€å˜èªå‰Šé™¤æ™‚ã€‘
    B->>SA: deleteVocabulary(id)
    SA->>P: prisma.word.delete({ where: { id } })
    P->>DB: DELETE FROM Word WHERE id = ?
    DB-->>P: OK
    P-->>SA: å‰Šé™¤æ¸ˆã¿
    SA-->>B: { success: true }
    B->>SC: router.refresh() ã§ãƒšãƒ¼ã‚¸å†å–å¾—
```

**Railsã¨ã®å¯¾æ¯”:**
| ã“ã®å›³ã®å‡¦ç† | Rails ã§ã®ç›¸å½“å‡¦ç† |
|---|---|
| Server Component ãŒãƒ‡ãƒ¼ã‚¿å–å¾— | Controller ã® `index` ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
| Server Action ãŒå‘¼ã°ã‚Œã‚‹ | Controller ã® `create` / `destroy` |
| `prisma.word.create()` | `Word.create(...)` |
| `prisma.word.findMany()` | `Word.all.order(created_at: :desc)` |
| `prisma.word.delete()` | `Word.find(id).destroy` |
| `router.refresh()` | `redirect_to` |

---

### 4. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆå›³

å„ãƒ«ãƒ¼ãƒˆã§ä½¿ã‚ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å½¹å‰²ã¨ã€Server/Client ã®åŒºåˆ†ã‚’ç¤ºã—ã¾ã™ã€‚

```mermaid
graph TD
    subgraph Layout["layout.tsxï¼ˆå…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰"]
        subgraph Route1["/ ãƒ«ãƒ¼ãƒˆ"]
            PageTsx["page.tsx<br/><b>Client Component</b><br/>useState ã§ã‚¿ã‚¹ã‚¯ç®¡ç†"]
        end
        subgraph Route2["/vocabulary ãƒ«ãƒ¼ãƒˆ"]
            VocabPage["page.tsx<br/><b>Server Component</b><br/>ãƒ‡ãƒ¼ã‚¿å–å¾— + ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º"]
            VocabList["VocabularyList.tsx<br/><b>Client Component</b><br/>ä¸€è¦§è¡¨ç¤º + å‰Šé™¤æ“ä½œ"]
            VocabActions["actions.ts<br/><b>Server Actions</b><br/>add / get / delete"]
        end
        subgraph Route3["/quiz ãƒ«ãƒ¼ãƒˆ"]
            QuizPage["page.tsx<br/><b>Server Component</b><br/>ãƒ©ãƒ³ãƒ€ãƒ ã«10ä»¶å–å¾—"]
            QuizPlayer["QuizPlayer.tsx<br/><b>Client Component</b><br/>1å•ãšã¤è¡¨ç¤º + é€²æ—ãƒãƒ¼"]
        end
    end

    VocabPage -->|"props"| VocabList
    VocabPage -->|"å‘¼ã³å‡ºã—"| VocabActions
    VocabList -->|"å‰Šé™¤æ™‚"| VocabActions
    QuizPage -->|"props"| QuizPlayer
    QuizPage -->|"å‘¼ã³å‡ºã—"| VocabActions

    subgraph Prisma["Prisma + SQLite"]
        PClient["lib/prisma.ts"]
        Database["dev.db"]
    end

    VocabActions -->|"DBæ“ä½œ"| PClient
    PClient --> Database

    style PageTsx fill:#312e81,stroke:#818cf8,color:#e0e7ff
    style VocabList fill:#312e81,stroke:#818cf8,color:#e0e7ff
    style QuizPlayer fill:#312e81,stroke:#818cf8,color:#e0e7ff
    style VocabPage fill:#0f172a,stroke:#38bdf8,color:#e0f2fe
    style QuizPage fill:#0f172a,stroke:#38bdf8,color:#e0f2fe
    style VocabActions fill:#0f172a,stroke:#f59e0b,color:#fef3c7
    style PClient fill:#1c1917,stroke:#a3e635,color:#ecfccb
    style Database fill:#1c1917,stroke:#a3e635,color:#ecfccb
```

**è‰²ã®æ„å‘³:**
| è‰² | åŒºåˆ† | å®Ÿè¡Œå ´æ‰€ |
|---|---|---|
| ç´« | Client Component | ãƒ–ãƒ©ã‚¦ã‚¶ |
| é’ | Server Component | ã‚µãƒ¼ãƒãƒ¼ |
| é»„ | Server Actions | ã‚µãƒ¼ãƒãƒ¼ |
| ç·‘ | Prisma / DB | ã‚µãƒ¼ãƒãƒ¼ |

---

### 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«å›³

ç¾åœ¨ã®DBã‚¹ã‚­ãƒ¼ãƒã‚’ç¤ºã—ã¾ã™ã€‚

```mermaid
erDiagram
    Word {
        Int id PK "è‡ªå‹•æ¡ç•ª"
        String english "è‹±å˜èª"
        String japanese "æ—¥æœ¬èªã®æ„å‘³"
        DateTime createdAt "ä½œæˆæ—¥æ™‚ï¼ˆè‡ªå‹•è¨­å®šï¼‰"
    }
```

**ä»Šå¾Œã®æ‹¡å¼µä¾‹:**
- `User` ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- `QuizResult` ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ã—ã¦æ­£è§£ç‡ã®è¨˜éŒ²
- `Word` ã« `category` ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã—ã¦åˆ†é¡æ©Ÿèƒ½

---

### 6. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯æ¦‚è¦å›³

```mermaid
graph LR
    subgraph Frontend["ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰"]
        React["React 19"]
        Tailwind["Tailwind CSS 4"]
        NextClient["Next.js<br/>Client Component"]
    end

    subgraph Backend["ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰"]
        NextServer["Next.js 16<br/>App Router"]
        ServerActions["Server Actions"]
        PrismaORM["Prisma v6<br/>ORM"]
    end

    subgraph Data["ãƒ‡ãƒ¼ã‚¿å±¤"]
        SQLiteDB["SQLite<br/>dev.db"]
    end

    subgraph Tools["é–‹ç™ºãƒ„ãƒ¼ãƒ«"]
        TS["TypeScript 5"]
        TSX["tsx<br/>TSå®Ÿè¡Œãƒ„ãƒ¼ãƒ«"]
        PrismaCLI["Prisma CLI<br/>ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"]
    end

    React --> NextClient
    Tailwind --> NextClient
    NextClient --> NextServer
    NextServer --> ServerActions
    ServerActions --> PrismaORM
    PrismaORM --> SQLiteDB
    TS --> NextServer
    TSX --> PrismaCLI
    PrismaCLI --> SQLiteDB
```
